<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">contracts</li><li class="chapter-item "><a href="contracts/common/index.html">‚ù± common</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/common/CanonicalMachine.sol/library.CanonicalMachine.html">CanonicalMachine</a></li><li class="chapter-item "><a href="contracts/common/InputEncoding.sol/library.InputEncoding.html">InputEncoding</a></li><li class="chapter-item "><a href="contracts/common/Inputs.sol/interface.Inputs.html">Inputs</a></li><li class="chapter-item "><a href="contracts/common/OutputValidityProof.sol/struct.OutputValidityProof.html">OutputValidityProof</a></li><li class="chapter-item "><a href="contracts/common/Outputs.sol/interface.Outputs.html">Outputs</a></li></ol></li><li class="chapter-item "><a href="contracts/consensus/index.html">‚ù± consensus</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/consensus/authority/index.html">‚ù± authority</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/consensus/authority/Authority.sol/contract.Authority.html">Authority</a></li><li class="chapter-item "><a href="contracts/consensus/authority/AuthorityFactory.sol/contract.AuthorityFactory.html">AuthorityFactory</a></li><li class="chapter-item "><a href="contracts/consensus/authority/IAuthorityFactory.sol/interface.IAuthorityFactory.html">IAuthorityFactory</a></li></ol></li><li class="chapter-item "><a href="contracts/consensus/quorum/index.html">‚ù± quorum</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/consensus/quorum/IQuorumFactory.sol/interface.IQuorumFactory.html">IQuorumFactory</a></li><li class="chapter-item "><a href="contracts/consensus/quorum/Quorum.sol/contract.Quorum.html">Quorum</a></li><li class="chapter-item "><a href="contracts/consensus/quorum/QuorumFactory.sol/contract.QuorumFactory.html">QuorumFactory</a></li></ol></li><li class="chapter-item "><a href="contracts/consensus/AbstractConsensus.sol/abstract.AbstractConsensus.html">AbstractConsensus</a></li><li class="chapter-item "><a href="contracts/consensus/IConsensus.sol/interface.IConsensus.html">IConsensus</a></li></ol></li><li class="chapter-item "><a href="contracts/dapp/index.html">‚ù± dapp</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/dapp/Application.sol/contract.Application.html">Application</a></li><li class="chapter-item "><a href="contracts/dapp/ApplicationFactory.sol/contract.ApplicationFactory.html">ApplicationFactory</a></li><li class="chapter-item "><a href="contracts/dapp/IApplication.sol/interface.IApplication.html">IApplication</a></li><li class="chapter-item "><a href="contracts/dapp/IApplicationFactory.sol/interface.IApplicationFactory.html">IApplicationFactory</a></li><li class="chapter-item "><a href="contracts/dapp/ISelfHostedApplicationFactory.sol/interface.ISelfHostedApplicationFactory.html">ISelfHostedApplicationFactory</a></li><li class="chapter-item "><a href="contracts/dapp/SelfHostedApplicationFactory.sol/contract.SelfHostedApplicationFactory.html">SelfHostedApplicationFactory</a></li></ol></li><li class="chapter-item "><a href="contracts/delegatecall/index.html">‚ù± delegatecall</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/delegatecall/SafeERC20Transfer.sol/contract.SafeERC20Transfer.html">SafeERC20Transfer</a></li></ol></li><li class="chapter-item "><a href="contracts/inputs/index.html">‚ù± inputs</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/inputs/IInputBox.sol/interface.IInputBox.html">IInputBox</a></li><li class="chapter-item "><a href="contracts/inputs/InputBox.sol/contract.InputBox.html">InputBox</a></li></ol></li><li class="chapter-item "><a href="contracts/library/index.html">‚ù± library</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/library/LibAddress.sol/library.LibAddress.html">LibAddress</a></li><li class="chapter-item "><a href="contracts/library/LibError.sol/library.LibError.html">LibError</a></li><li class="chapter-item "><a href="contracts/library/LibMerkle32.sol/library.LibMerkle32.html">LibMerkle32</a></li><li class="chapter-item "><a href="contracts/library/LibOutputValidityProof.sol/library.LibOutputValidityProof.html">LibOutputValidityProof</a></li></ol></li><li class="chapter-item "><a href="contracts/portals/index.html">‚ù± portals</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/portals/ERC1155BatchPortal.sol/contract.ERC1155BatchPortal.html">ERC1155BatchPortal</a></li><li class="chapter-item "><a href="contracts/portals/ERC1155SinglePortal.sol/contract.ERC1155SinglePortal.html">ERC1155SinglePortal</a></li><li class="chapter-item "><a href="contracts/portals/ERC20Portal.sol/contract.ERC20Portal.html">ERC20Portal</a></li><li class="chapter-item "><a href="contracts/portals/ERC721Portal.sol/contract.ERC721Portal.html">ERC721Portal</a></li><li class="chapter-item "><a href="contracts/portals/EtherPortal.sol/contract.EtherPortal.html">EtherPortal</a></li><li class="chapter-item "><a href="contracts/portals/IERC1155BatchPortal.sol/interface.IERC1155BatchPortal.html">IERC1155BatchPortal</a></li><li class="chapter-item "><a href="contracts/portals/IERC1155SinglePortal.sol/interface.IERC1155SinglePortal.html">IERC1155SinglePortal</a></li><li class="chapter-item "><a href="contracts/portals/IERC20Portal.sol/interface.IERC20Portal.html">IERC20Portal</a></li><li class="chapter-item "><a href="contracts/portals/IERC721Portal.sol/interface.IERC721Portal.html">IERC721Portal</a></li><li class="chapter-item "><a href="contracts/portals/IEtherPortal.sol/interface.IEtherPortal.html">IEtherPortal</a></li><li class="chapter-item "><a href="contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></li><li class="chapter-item "><a href="contracts/portals/Portal.sol/contract.Portal.html">Portal</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cartesi/rollups-contracts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="smart-contracts-for-cartesi-rollups"><a class="header" href="#smart-contracts-for-cartesi-rollups">Smart Contracts for Cartesi Rollups</a></h1>
<p>This repository contains the on-chain part of Cartesi Rollups.</p>
<p>If you are interested in taking a look at the off-chain part, please, head over to <a href="https://github.com/cartesi/rollups-node"><code>cartesi/rollups-node</code></a>.</p>
<h2 id="-dependencies"><a class="header" href="#-dependencies">üß© Dependencies</a></h2>
<ul>
<li><a href="https://pnpm.io/installation">pnpm</a></li>
<li><a href="https://book.getfoundry.sh/getting-started/installation">Forge</a></li>
</ul>
<h2 id="-basic-setup"><a class="header" href="#-basic-setup">üí° Basic setup</a></h2>
<p>This repository contains <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">git submodules</a>.
In order to properly initialize them, please, run the following command.</p>
<pre><code class="language-sh">git submodule update --init --recursive
</code></pre>
<p>This repository uses <a href="https://pnpm.io/installation">pnpm</a> to manage JavaScript dependencies.
In order to install them, please, run the following command.</p>
<pre><code class="language-sh">pnpm i
</code></pre>
<h2 id="-local-deployment"><a class="header" href="#-local-deployment">üöÄ Local deployment</a></h2>
<p>If you want to run a <a href="https://hardhat.org/">Hardhat</a> node and deploy the contracts, please run the following command.</p>
<pre><code class="language-sh">pnpm start
</code></pre>
<p>If, instead, you wish to deploy the contracts to an already running node (e.g. <a href="https://book.getfoundry.sh/anvil/">Anvil</a>), you can do so by running the following command.</p>
<pre><code class="language-sh">pnpm deploy:development
</code></pre>
<p>If the node is not listening to <code>http://localhost:8545/</code>, please set the <code>RPC_URL</code> environment variable accordingly.</p>
<h2 id="-tests"><a class="header" href="#-tests">üß™ Tests</a></h2>
<p>If you want to run the tests, please run the following command.</p>
<pre><code class="language-sh">forge test -vvv
</code></pre>
<h2 id="-documentation"><a class="header" href="#-documentation">üìö Documentation</a></h2>
<p>üöÄ Smart contract documentation is kept up-to-date and deployed <a href="https://cartesi.github.io/rollups-contracts"><strong>here</strong></a>.</p>
<p>‚ÑπÔ∏è You may also want to check the <a href="https://docs.cartesi.io/cartesi-rollups/overview/">official Cartesi Rollups documentation website</a>.</p>
<p>üîé For an in-depth view of the on-chain architecture, we invite you to take a look at the <a href="https://github.com/cartesi/rollups-contracts/blob/main/CONTRACTS.md"><code>CONTRACTS.md</code></a> file.</p>
<h2 id="-experimenting"><a class="header" href="#-experimenting">üé® Experimenting</a></h2>
<p>To get a taste of how to use Cartesi to develop your DApp, check the following resources:
See Cartesi Rollups in action with the Simple Echo Examples in <a href="https://github.com/cartesi/rollups-examples/tree/main/echo-cpp">C++</a>, <a href="https://github.com/cartesi/rollups-examples/tree/main/echo-js">JavaScript</a>, <a href="https://github.com/cartesi/rollups-examples/tree/main/echo-lua">Lua</a>, <a href="https://github.com/cartesi/rollups-examples/tree/main/echo-rust">Rust</a> and <a href="https://github.com/cartesi/rollups-examples/tree/main/echo-python">Python</a>.
To have a glimpse of how to develop your DApp locally using your favorite IDE and tools check our Host Environment in the <a href="https://github.com/cartesi/rollups-examples">Rollups Examples</a> repository.</p>
<h2 id="-talk-with-us"><a class="header" href="#-talk-with-us">üí¨ Talk with us</a></h2>
<p>If you're interested in developing with Cartesi, working with the team, or hanging out in our community, don't forget to <a href="https://discordapp.com/invite/Pt2NrnS">join us on Discord and follow along</a>.</p>
<p>Want to stay up to date? Make sure to join our <a href="https://t.me/CartesiAnnouncements">announcements channel on Telegram</a> or <a href="https://twitter.com/cartesiproject">follow our Twitter</a>.</p>
<h2 id="-contributing"><a class="header" href="#-contributing">ü§ù Contributing</a></h2>
<p>Thank you for your interest in Cartesi! Head over to our <a href="CONTRIBUTING.html">Contributing Guidelines</a> for instructions on how to sign our Contributors Agreement and get started with Cartesi!</p>
<p>Please note we have a <a href="CODE_OF_CONDUCT.html">Code of Conduct</a>, please follow it in all your interactions with the project.</p>
<h2 id="-license"><a class="header" href="#-license">üìú License</a></h2>
<p>Note: This component currently has dependencies that are licensed under the GNU GPL, version 3, and so you should treat this component as a whole as being under the GPL version 3. But all Cartesi-written code in this component is licensed under the Apache License, version 2, or a compatible permissive license, and can be used independently under the Apache v2 license. After this component is rewritten, the entire component will be released under the Apache v2 license.
The arbitration d-lib repository and all contributions are licensed under
<a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPL 3</a>. Please review our <a href="COPYING">COPYING</a> file.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="contracts/common/CanonicalMachine.sol/library.CanonicalMachine.html">CanonicalMachine</a></li>
<li><a href="contracts/common/InputEncoding.sol/library.InputEncoding.html">InputEncoding</a></li>
<li><a href="contracts/common/Inputs.sol/interface.Inputs.html">Inputs</a></li>
<li><a href="contracts/common/OutputValidityProof.sol/struct.OutputValidityProof.html">OutputValidityProof</a></li>
<li><a href="contracts/common/Outputs.sol/interface.Outputs.html">Outputs</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="canonicalmachine"><a class="header" href="#canonicalmachine">CanonicalMachine</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/common/CanonicalMachine.sol">Git Source</a></p>
<p>Defines several constants related to the reference implementation
of the RISC-V machine that runs Linux, also known as the "Cartesi Machine".</p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="input_max_size"><a class="header" href="#input_max_size">INPUT_MAX_SIZE</a></h3>
<p>Maximum input size (2 megabytes).</p>
<pre><code class="language-solidity">uint256 constant INPUT_MAX_SIZE = 1 &lt;&lt; 21;
</code></pre>
<h3 id="log2_max_outputs"><a class="header" href="#log2_max_outputs">LOG2_MAX_OUTPUTS</a></h3>
<p>Log2 of maximum number of outputs.</p>
<pre><code class="language-solidity">uint256 constant LOG2_MAX_OUTPUTS = 63;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inputencoding"><a class="header" href="#inputencoding">InputEncoding</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/common/InputEncoding.sol">Git Source</a></p>
<p>Defines the encoding of inputs added by core trustless and
permissionless contracts, such as portals.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="encodeetherdeposit"><a class="header" href="#encodeetherdeposit">encodeEtherDeposit</a></h3>
<p>Encode an Ether deposit.</p>
<pre><code class="language-solidity">function encodeEtherDeposit(address sender, uint256 value, bytes calldata execLayerData)
    internal
    pure
    returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sender</code></td><td><code>address</code></td><td>The Ether sender</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The amount of Wei being sent</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td>The encoded input payload</td></tr>
</tbody></table>
</div>
<h3 id="encodeerc20deposit"><a class="header" href="#encodeerc20deposit">encodeERC20Deposit</a></h3>
<p>Encode an ERC-20 token deposit.</p>
<pre><code class="language-solidity">function encodeERC20Deposit(IERC20 token, address sender, uint256 value, bytes calldata execLayerData)
    internal
    pure
    returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC20</code></td><td>The token contract</td></tr>
<tr><td><code>sender</code></td><td><code>address</code></td><td>The token sender</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The amount of tokens being sent</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td>The encoded input payload</td></tr>
</tbody></table>
</div>
<h3 id="encodeerc721deposit"><a class="header" href="#encodeerc721deposit">encodeERC721Deposit</a></h3>
<p>Encode an ERC-721 token deposit.</p>
<p><em><code>baseLayerData</code> should be forwarded to <code>token</code>.</em></p>
<pre><code class="language-solidity">function encodeERC721Deposit(
    IERC721 token,
    address sender,
    uint256 tokenId,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) internal pure returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC721</code></td><td>The token contract</td></tr>
<tr><td><code>sender</code></td><td><code>address</code></td><td>The token sender</td></tr>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The token identifier</td></tr>
<tr><td><code>baseLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the base layer</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td>The encoded input payload</td></tr>
</tbody></table>
</div>
<h3 id="encodesingleerc1155deposit"><a class="header" href="#encodesingleerc1155deposit">encodeSingleERC1155Deposit</a></h3>
<p>Encode an ERC-1155 single token deposit.</p>
<p><em><code>baseLayerData</code> should be forwarded to <code>token</code>.</em></p>
<pre><code class="language-solidity">function encodeSingleERC1155Deposit(
    IERC1155 token,
    address sender,
    uint256 tokenId,
    uint256 value,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) internal pure returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC1155</code></td><td>The ERC-1155 token contract</td></tr>
<tr><td><code>sender</code></td><td><code>address</code></td><td>The token sender</td></tr>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The identifier of the token being transferred</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>Transfer amount</td></tr>
<tr><td><code>baseLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the base layer</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td>The encoded input payload</td></tr>
</tbody></table>
</div>
<h3 id="encodebatcherc1155deposit"><a class="header" href="#encodebatcherc1155deposit">encodeBatchERC1155Deposit</a></h3>
<p>Encode an ERC-1155 batch token deposit.</p>
<p><em><code>baseLayerData</code> should be forwarded to <code>token</code>.</em></p>
<pre><code class="language-solidity">function encodeBatchERC1155Deposit(
    IERC1155 token,
    address sender,
    uint256[] calldata tokenIds,
    uint256[] calldata values,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) internal pure returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC1155</code></td><td>The ERC-1155 token contract</td></tr>
<tr><td><code>sender</code></td><td><code>address</code></td><td>The token sender</td></tr>
<tr><td><code>tokenIds</code></td><td><code>uint256[]</code></td><td>The identifiers of the tokens being transferred</td></tr>
<tr><td><code>values</code></td><td><code>uint256[]</code></td><td>Transfer amounts per token type</td></tr>
<tr><td><code>baseLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the base layer</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td>The encoded input payload</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="inputs"><a class="header" href="#inputs">Inputs</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/common/Inputs.sol">Git Source</a></p>
<p>Defines the signatures of inputs.</p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="evmadvance"><a class="header" href="#evmadvance">EvmAdvance</a></h3>
<p>An advance request from an EVM-compatible blockchain to a Cartesi Machine.</p>
<p><em>See EIP-4399 for safe usage of <code>prevRandao</code>.</em></p>
<pre><code class="language-solidity">function EvmAdvance(
    uint256 chainId,
    address appContract,
    address msgSender,
    uint256 blockNumber,
    uint256 blockTimestamp,
    uint256 prevRandao,
    uint256 index,
    bytes calldata payload
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chainId</code></td><td><code>uint256</code></td><td>The chain ID</td></tr>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>msgSender</code></td><td><code>address</code></td><td>The address of whoever sent the input</td></tr>
<tr><td><code>blockNumber</code></td><td><code>uint256</code></td><td>The number of the block in which the input was added</td></tr>
<tr><td><code>blockTimestamp</code></td><td><code>uint256</code></td><td>The timestamp of the block in which the input was added</td></tr>
<tr><td><code>prevRandao</code></td><td><code>uint256</code></td><td>The latest RANDAO mix of the post beacon state of the previous block</td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The index of the input in the input box</td></tr>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>The payload provided by the message sender</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="outputvalidityproof"><a class="header" href="#outputvalidityproof">OutputValidityProof</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/common/OutputValidityProof.sol">Git Source</a></p>
<p>Proof of inclusion of an output in the output Merkle tree.</p>
<p><em>From the index and siblings, one can calculate the root of the Merkle tree.</em></p>
<p><em>The siblings array should have size equal to the log2 of the maximum number of outputs.</em></p>
<p><em>See the <code>CanonicalMachine</code> library for constants.</em></p>
<pre><code class="language-solidity">struct OutputValidityProof {
    uint64 outputIndex;
    bytes32[] outputHashesSiblings;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>outputIndex</code></td><td><code>uint64</code></td><td>Index of output in the Merkle tree</td></tr>
<tr><td><code>outputHashesSiblings</code></td><td><code>bytes32[]</code></td><td>Siblings of the output in the Merkle tree</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="outputs"><a class="header" href="#outputs">Outputs</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/common/Outputs.sol">Git Source</a></p>
<p>Defines the signatures of outputs that can be generated by the
off-chain machine and verified by the on-chain contracts.</p>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="notice"><a class="header" href="#notice">Notice</a></h3>
<p>A piece of verifiable information.</p>
<pre><code class="language-solidity">function Notice(bytes calldata payload) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>An arbitrary payload.</td></tr>
</tbody></table>
</div>
<h3 id="voucher"><a class="header" href="#voucher">Voucher</a></h3>
<p>A single-use permission to execute a specific message call
from the context of the application contract.</p>
<pre><code class="language-solidity">function Voucher(address destination, uint256 value, bytes calldata payload) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>destination</code></td><td><code>address</code></td><td>The address that will be called</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The amount of Wei to be transferred through the call</td></tr>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>The payload, which‚Äîin the case of Solidity contracts‚Äîencodes a function call</td></tr>
</tbody></table>
</div>
<h3 id="delegatecallvoucher"><a class="header" href="#delegatecallvoucher">DelegateCallVoucher</a></h3>
<p>A single-use permission to execute a specific delegate call
from the context of the application contract.</p>
<pre><code class="language-solidity">function DelegateCallVoucher(address destination, bytes calldata payload) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>destination</code></td><td><code>address</code></td><td>The address that will be called</td></tr>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>The payload, which‚Äîin the case of Solidity libraries‚Äîencodes a function call</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-1"><a class="header" href="#contents-1">Contents</a></h1>
<ul>
<li><a href="contracts/consensus/../../contracts/consensus/authority/index.html">authority</a></li>
<li><a href="contracts/consensus/../../contracts/consensus/quorum/index.html">quorum</a></li>
<li><a href="contracts/consensus/AbstractConsensus.sol/abstract.AbstractConsensus.html">AbstractConsensus</a></li>
<li><a href="contracts/consensus/IConsensus.sol/interface.IConsensus.html">IConsensus</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-2"><a class="header" href="#contents-2">Contents</a></h1>
<ul>
<li><a href="contracts/consensus/authority/Authority.sol/contract.Authority.html">Authority</a></li>
<li><a href="contracts/consensus/authority/AuthorityFactory.sol/contract.AuthorityFactory.html">AuthorityFactory</a></li>
<li><a href="contracts/consensus/authority/IAuthorityFactory.sol/interface.IAuthorityFactory.html">IAuthorityFactory</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="authority"><a class="header" href="#authority">Authority</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/authority/Authority.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/consensus/authority/Authority.sol/../../../contracts/consensus/AbstractConsensus.sol/abstract.AbstractConsensus.html">AbstractConsensus</a>, Ownable</p>
<p>A consensus contract controlled by a single address, the owner.</p>
<p><em>This contract inherits from OpenZeppelin's <code>Ownable</code> contract.
For more information on <code>Ownable</code>, please consult OpenZeppelin's official documentation.</em></p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<pre><code class="language-solidity">constructor(address initialOwner) Ownable(initialOwner);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>initialOwner</code></td><td><code>address</code></td><td>The initial contract owner</td></tr>
</tbody></table>
</div>
<h3 id="submitclaim"><a class="header" href="#submitclaim">submitClaim</a></h3>
<p>Submit a claim.</p>
<p><em>Fires a <code>ClaimSubmission</code> event and a <code>ClaimAcceptance</code> event.</em></p>
<p><em>Can only be called by the owner.</em></p>
<pre><code class="language-solidity">function submitClaim(address appContract, bytes32 claim) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="authorityfactory"><a class="header" href="#authorityfactory">AuthorityFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/authority/AuthorityFactory.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/consensus/authority/AuthorityFactory.sol/../../../contracts/consensus/authority/IAuthorityFactory.sol/interface.IAuthorityFactory.html">IAuthorityFactory</a></p>
<p>Allows anyone to reliably deploy a new <code>Authority</code> contract.</p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="newauthority"><a class="header" href="#newauthority">newAuthority</a></h3>
<pre><code class="language-solidity">function newAuthority(address authorityOwner) external override returns (Authority);
</code></pre>
<h3 id="newauthority-1"><a class="header" href="#newauthority-1">newAuthority</a></h3>
<pre><code class="language-solidity">function newAuthority(address authorityOwner, bytes32 salt) external override returns (Authority);
</code></pre>
<h3 id="calculateauthorityaddress"><a class="header" href="#calculateauthorityaddress">calculateAuthorityAddress</a></h3>
<pre><code class="language-solidity">function calculateAuthorityAddress(address authorityOwner, bytes32 salt) external view override returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iauthorityfactory"><a class="header" href="#iauthorityfactory">IAuthorityFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/authority/IAuthorityFactory.sol">Git Source</a></p>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="newauthority-2"><a class="header" href="#newauthority-2">newAuthority</a></h3>
<p>Deploy a new authority.</p>
<p><em>On success, MUST emit an <code>AuthorityCreated</code> event.</em></p>
<pre><code class="language-solidity">function newAuthority(address authorityOwner) external returns (Authority);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>authorityOwner</code></td><td><code>address</code></td><td>The initial authority owner</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Authority</code></td><td>The authority</td></tr>
</tbody></table>
</div>
<h3 id="newauthority-3"><a class="header" href="#newauthority-3">newAuthority</a></h3>
<p>Deploy a new authority deterministically.</p>
<p><em>On success, MUST emit an <code>AuthorityCreated</code> event.</em></p>
<pre><code class="language-solidity">function newAuthority(address authorityOwner, bytes32 salt) external returns (Authority);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>authorityOwner</code></td><td><code>address</code></td><td>The initial authority owner</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the authority address</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Authority</code></td><td>The authority</td></tr>
</tbody></table>
</div>
<h3 id="calculateauthorityaddress-1"><a class="header" href="#calculateauthorityaddress-1">calculateAuthorityAddress</a></h3>
<p>Calculate the address of an authority to be deployed deterministically.</p>
<p><em>Beware that only the <code>newAuthority</code> function with the <code>salt</code> parameter
is able to deterministically deploy an authority.</em></p>
<pre><code class="language-solidity">function calculateAuthorityAddress(address authorityOwner, bytes32 salt) external view returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>authorityOwner</code></td><td><code>address</code></td><td>The initial authority owner</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the authority address</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The deterministic authority address</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="authoritycreated"><a class="header" href="#authoritycreated">AuthorityCreated</a></h3>
<p>A new authority was deployed.</p>
<p><em>MUST be triggered on a successful call to <code>newAuthority</code>.</em></p>
<pre><code class="language-solidity">event AuthorityCreated(address authorityOwner, Authority authority);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>authorityOwner</code></td><td><code>address</code></td><td>The initial authority owner</td></tr>
<tr><td><code>authority</code></td><td><code>Authority</code></td><td>The authority</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-3"><a class="header" href="#contents-3">Contents</a></h1>
<ul>
<li><a href="contracts/consensus/quorum/IQuorumFactory.sol/interface.IQuorumFactory.html">IQuorumFactory</a></li>
<li><a href="contracts/consensus/quorum/Quorum.sol/contract.Quorum.html">Quorum</a></li>
<li><a href="contracts/consensus/quorum/QuorumFactory.sol/contract.QuorumFactory.html">QuorumFactory</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iquorumfactory"><a class="header" href="#iquorumfactory">IQuorumFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/quorum/IQuorumFactory.sol">Git Source</a></p>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="newquorum"><a class="header" href="#newquorum">newQuorum</a></h3>
<p>Deploy a new quorum.</p>
<p><em>On success, MUST emit a <code>QuorumCreated</code> event.</em></p>
<pre><code class="language-solidity">function newQuorum(address[] calldata validators) external returns (Quorum);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>validators</code></td><td><code>address[]</code></td><td>the list of validators</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Quorum</code></td><td>The quorum</td></tr>
</tbody></table>
</div>
<h3 id="newquorum-1"><a class="header" href="#newquorum-1">newQuorum</a></h3>
<p>Deploy a new quorum deterministically.</p>
<p><em>On success, MUST emit a <code>QuorumCreated</code> event.</em></p>
<pre><code class="language-solidity">function newQuorum(address[] calldata validators, bytes32 salt) external returns (Quorum);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>validators</code></td><td><code>address[]</code></td><td>the list of validators</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the quorum address</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Quorum</code></td><td>The quorum</td></tr>
</tbody></table>
</div>
<h3 id="calculatequorumaddress"><a class="header" href="#calculatequorumaddress">calculateQuorumAddress</a></h3>
<p>Calculate the address of a quorum to be deployed deterministically.</p>
<p><em>Beware that only the <code>newQuorum</code> function with the <code>salt</code> parameter
is able to deterministically deploy a quorum.</em></p>
<pre><code class="language-solidity">function calculateQuorumAddress(address[] calldata validators, bytes32 salt) external view returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>validators</code></td><td><code>address[]</code></td><td>the list of validators</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the quorum address</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The deterministic quorum address</td></tr>
</tbody></table>
</div>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="quorumcreated"><a class="header" href="#quorumcreated">QuorumCreated</a></h3>
<p>A new quorum was deployed.</p>
<p><em>MUST be triggered on a successful call to <code>newQuorum</code>.</em></p>
<pre><code class="language-solidity">event QuorumCreated(Quorum quorum);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>quorum</code></td><td><code>Quorum</code></td><td>The quorum</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="quorum"><a class="header" href="#quorum">Quorum</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/quorum/Quorum.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/consensus/quorum/Quorum.sol/../../../contracts/consensus/AbstractConsensus.sol/abstract.AbstractConsensus.html">AbstractConsensus</a></p>
<p>A consensus model controlled by a small, immutable set of <code>n</code> validators.</p>
<p>You can know the value of <code>n</code> by calling the <code>numOfValidators</code> function.</p>
<p>Upon construction, each validator is assigned a unique number between 1 and <code>n</code>.
These numbers are used internally instead of addresses for gas optimization reasons.</p>
<p>You can list the validators in the quorum by calling the <code>validatorById</code>
function for each ID from 1 to <code>n</code>.</p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="_numofvalidators"><a class="header" href="#_numofvalidators">_numOfValidators</a></h3>
<p>The total number of validators.</p>
<p>See the <code>numOfValidators</code> function.</p>
<pre><code class="language-solidity">uint256 private immutable _numOfValidators;
</code></pre>
<h3 id="_validatorid"><a class="header" href="#_validatorid">_validatorId</a></h3>
<p>Validator IDs indexed by address.</p>
<p>See the <code>validatorId</code> function.</p>
<p><em>Non-validators are assigned to ID zero.</em></p>
<p><em>Validators have IDs greater than zero.</em></p>
<pre><code class="language-solidity">mapping(address =&gt; uint256) private _validatorId;
</code></pre>
<h3 id="_validatorbyid"><a class="header" href="#_validatorbyid">_validatorById</a></h3>
<p>Validator addresses indexed by ID.</p>
<p>See the <code>validatorById</code> function.</p>
<p><em>Invalid IDs map to address zero.</em></p>
<pre><code class="language-solidity">mapping(uint256 =&gt; address) private _validatorById;
</code></pre>
<h3 id="_votes"><a class="header" href="#_votes">_votes</a></h3>
<p>Votes indexed by application contract address and claim.</p>
<p><em>See the <code>numOfValidatorsInFavorOf</code> and <code>isValidatorInFavorOf</code> functions.</em></p>
<pre><code class="language-solidity">mapping(address =&gt; mapping(bytes32 =&gt; Votes)) private _votes;
</code></pre>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="constructor-1"><a class="header" href="#constructor-1">constructor</a></h3>
<p><em>Duplicates in the <code>validators</code> array are ignored.</em></p>
<pre><code class="language-solidity">constructor(address[] memory validators);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>validators</code></td><td><code>address[]</code></td><td>The array of validator addresses</td></tr>
</tbody></table>
</div>
<h3 id="submitclaim-1"><a class="header" href="#submitclaim-1">submitClaim</a></h3>
<p>Submit a claim.</p>
<p><em>Fires a <code>ClaimSubmission</code> event if the message sender is a validator.</em></p>
<p><em>Fires a <code>ClaimAcceptance</code> event if the claim reaches a majority.</em></p>
<p><em>Can only be called by a validator.</em></p>
<pre><code class="language-solidity">function submitClaim(address appContract, bytes32 claim) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<h3 id="numofvalidators"><a class="header" href="#numofvalidators">numOfValidators</a></h3>
<p>Get the number of validators.</p>
<pre><code class="language-solidity">function numOfValidators() external view returns (uint256);
</code></pre>
<h3 id="validatorid"><a class="header" href="#validatorid">validatorId</a></h3>
<p>Get the ID of a validator.</p>
<p><em>Validators have IDs greater than zero.</em></p>
<p><em>Non-validators are assigned to ID zero.</em></p>
<pre><code class="language-solidity">function validatorId(address validator) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>validator</code></td><td><code>address</code></td><td>The validator address</td></tr>
</tbody></table>
</div>
<h3 id="validatorbyid"><a class="header" href="#validatorbyid">validatorById</a></h3>
<p>Get the address of a validator by its ID.</p>
<p><em>Validator IDs range from 1 to <code>N</code>, the total number of validators.</em></p>
<p><em>Invalid IDs map to address zero.</em></p>
<pre><code class="language-solidity">function validatorById(uint256 id) external view returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>id</code></td><td><code>uint256</code></td><td>The validator ID</td></tr>
</tbody></table>
</div>
<h3 id="numofvalidatorsinfavorof"><a class="header" href="#numofvalidatorsinfavorof">numOfValidatorsInFavorOf</a></h3>
<p>Get the number of validators in favor of a claim.</p>
<pre><code class="language-solidity">function numOfValidatorsInFavorOf(address appContract, bytes32 claim) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Number of validators in favor of claim</td></tr>
</tbody></table>
</div>
<h3 id="isvalidatorinfavorof"><a class="header" href="#isvalidatorinfavorof">isValidatorInFavorOf</a></h3>
<p>Check whether a validator is in favor of a claim.</p>
<p><em>Assumes the provided ID is valid.</em></p>
<pre><code class="language-solidity">function isValidatorInFavorOf(address appContract, bytes32 claim, uint256 id) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
<tr><td><code>id</code></td><td><code>uint256</code></td><td>The ID of the validator</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether validator is in favor of claim</td></tr>
</tbody></table>
</div>
<h3 id="_getvotes"><a class="header" href="#_getvotes">_getVotes</a></h3>
<p>Get a <code>Votes</code> structure from storage from a given claim.</p>
<pre><code class="language-solidity">function _getVotes(address appContract, bytes32 claim) internal view returns (Votes storage);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Votes</code></td><td>The <code>Votes</code> structure related to a given claim</td></tr>
</tbody></table>
</div>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="votes"><a class="header" href="#votes">Votes</a></h3>
<p>Votes in favor of a particular claim.</p>
<p><em><code>inFavorById</code> is a bitmap indexed by validator IDs.</em></p>
<pre><code class="language-solidity">struct Votes {
    uint256 inFavorCount;
    BitMaps.BitMap inFavorById;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>inFavorCount</code></td><td><code>uint256</code></td><td>The number of validators in favor of the claim</td></tr>
<tr><td><code>inFavorById</code></td><td><code>BitMaps.BitMap</code></td><td>The set of validators in favor of the claim</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="quorumfactory"><a class="header" href="#quorumfactory">QuorumFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/quorum/QuorumFactory.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/consensus/quorum/QuorumFactory.sol/../../../contracts/consensus/quorum/IQuorumFactory.sol/interface.IQuorumFactory.html">IQuorumFactory</a></p>
<p>Allows anyone to reliably deploy a new <code>Quorum</code> contract.</p>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="newquorum-2"><a class="header" href="#newquorum-2">newQuorum</a></h3>
<pre><code class="language-solidity">function newQuorum(address[] calldata validators) external override returns (Quorum);
</code></pre>
<h3 id="newquorum-3"><a class="header" href="#newquorum-3">newQuorum</a></h3>
<pre><code class="language-solidity">function newQuorum(address[] calldata validators, bytes32 salt) external override returns (Quorum);
</code></pre>
<h3 id="calculatequorumaddress-1"><a class="header" href="#calculatequorumaddress-1">calculateQuorumAddress</a></h3>
<pre><code class="language-solidity">function calculateQuorumAddress(address[] calldata validators, bytes32 salt) external view override returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="abstractconsensus"><a class="header" href="#abstractconsensus">AbstractConsensus</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/AbstractConsensus.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/consensus/AbstractConsensus.sol/../../../contracts/consensus/IConsensus.sol/interface.IConsensus.html">IConsensus</a></p>
<p>Stores accepted claims for several applications.</p>
<p><em>This contract was designed to be inherited by implementations of the <code>IConsensus</code> interface
that only need a simple mechanism of storage and retrieval of accepted claims.</em></p>
<h2 id="state-variables-2"><a class="header" href="#state-variables-2">State Variables</a></h2>
<h3 id="_acceptedclaims"><a class="header" href="#_acceptedclaims">_acceptedClaims</a></h3>
<p>Indexes accepted claims by application contract address.</p>
<pre><code class="language-solidity">mapping(address =&gt; mapping(bytes32 =&gt; bool)) private _acceptedClaims;
</code></pre>
<h2 id="functions-9"><a class="header" href="#functions-9">Functions</a></h2>
<h3 id="wasclaimaccepted"><a class="header" href="#wasclaimaccepted">wasClaimAccepted</a></h3>
<p>Check if an output Merkle root hash was ever accepted by the consensus
for a particular application.</p>
<pre><code class="language-solidity">function wasClaimAccepted(address appContract, bytes32 claim) public view override returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<h3 id="_acceptclaim"><a class="header" href="#_acceptclaim">_acceptClaim</a></h3>
<p>Accept a claim.</p>
<p><em>Emits a <code>ClaimAcceptance</code> event.</em></p>
<pre><code class="language-solidity">function _acceptClaim(address appContract, bytes32 claim) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="iconsensus"><a class="header" href="#iconsensus">IConsensus</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/consensus/IConsensus.sol">Git Source</a></p>
<p>Provides consensus over the set of valid output Merkle root hashes for applications.</p>
<p>The latest output Merkle root hash is available after the machine processes every input.
This hash can be later used to prove that any given output was ever produced by the machine.</p>
<p>After an epoch is finalized, a validator may submit a claim containing the application contract address,
and the output Merkle root hash.</p>
<p>Validators may synchronize epoch finalization, but such mechanism is not specified by this interface.</p>
<p>A validator should be able to save transaction fees by not submitting a claim if it was...</p>
<ul>
<li>already submitted by the validator (see the <code>ClaimSubmission</code> event) or;</li>
<li>already accepted by the consensus (see the <code>ClaimAcceptance</code> event).</li>
</ul>
<p>The acceptance criteria for claims may depend on the type of consensus, and is not specified by this interface.
For example, a claim may be accepted if it was...</p>
<ul>
<li>submitted by an authority or;</li>
<li>submitted by the majority of a quorum or;</li>
<li>submitted and not proven wrong after some period of time or;</li>
<li>submitted and proven correct through an on-chain tournament.</li>
</ul>
<h2 id="functions-10"><a class="header" href="#functions-10">Functions</a></h2>
<h3 id="submitclaim-2"><a class="header" href="#submitclaim-2">submitClaim</a></h3>
<p>Submit a claim to the consensus.</p>
<p><em>MUST fire a <code>ClaimSubmission</code> event.</em></p>
<p><em>MAY fire a <code>ClaimAcceptance</code> event, if the acceptance criteria is met.</em></p>
<pre><code class="language-solidity">function submitClaim(address appContract, bytes32 claim) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<h3 id="wasclaimaccepted-1"><a class="header" href="#wasclaimaccepted-1">wasClaimAccepted</a></h3>
<p>Check if an output Merkle root hash was ever accepted by the consensus
for a particular application.</p>
<pre><code class="language-solidity">function wasClaimAccepted(address appContract, bytes32 claim) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<h2 id="events-2"><a class="header" href="#events-2">Events</a></h2>
<h3 id="claimsubmission"><a class="header" href="#claimsubmission">ClaimSubmission</a></h3>
<p>MUST trigger when a claim is submitted.</p>
<pre><code class="language-solidity">event ClaimSubmission(address indexed submitter, address indexed appContract, bytes32 claim);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>submitter</code></td><td><code>address</code></td><td>The submitter address</td></tr>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<h3 id="claimacceptance"><a class="header" href="#claimacceptance">ClaimAcceptance</a></h3>
<p>MUST trigger when a claim is accepted.</p>
<p><em>MUST be triggered after some <code>ClaimSubmission</code> event regarding <code>appContract</code>.</em></p>
<pre><code class="language-solidity">event ClaimAcceptance(address indexed appContract, bytes32 claim);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-4"><a class="header" href="#contents-4">Contents</a></h1>
<ul>
<li><a href="contracts/dapp/Application.sol/contract.Application.html">Application</a></li>
<li><a href="contracts/dapp/ApplicationFactory.sol/contract.ApplicationFactory.html">ApplicationFactory</a></li>
<li><a href="contracts/dapp/IApplication.sol/interface.IApplication.html">IApplication</a></li>
<li><a href="contracts/dapp/IApplicationFactory.sol/interface.IApplicationFactory.html">IApplicationFactory</a></li>
<li><a href="contracts/dapp/ISelfHostedApplicationFactory.sol/interface.ISelfHostedApplicationFactory.html">ISelfHostedApplicationFactory</a></li>
<li><a href="contracts/dapp/SelfHostedApplicationFactory.sol/contract.SelfHostedApplicationFactory.html">SelfHostedApplicationFactory</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="application"><a class="header" href="#application">Application</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/dapp/Application.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/dapp/Application.sol/../../../contracts/dapp/IApplication.sol/interface.IApplication.html">IApplication</a>, Ownable, ERC721Holder, ERC1155Holder, ReentrancyGuard</p>
<h2 id="state-variables-3"><a class="header" href="#state-variables-3">State Variables</a></h2>
<h3 id="_templatehash"><a class="header" href="#_templatehash">_templateHash</a></h3>
<p>The initial machine state hash.</p>
<p><em>See the <code>getTemplateHash</code> function.</em></p>
<pre><code class="language-solidity">bytes32 internal immutable _templateHash;
</code></pre>
<h3 id="_executed"><a class="header" href="#_executed">_executed</a></h3>
<p>Keeps track of which outputs have been executed.</p>
<p><em>See the <code>wasOutputExecuted</code> function.</em></p>
<pre><code class="language-solidity">BitMaps.BitMap internal _executed;
</code></pre>
<h3 id="_consensus"><a class="header" href="#_consensus">_consensus</a></h3>
<p>The current consensus contract.</p>
<p><em>See the <code>getConsensus</code> and <code>migrateToConsensus</code> functions.</em></p>
<pre><code class="language-solidity">IConsensus internal _consensus;
</code></pre>
<h2 id="functions-11"><a class="header" href="#functions-11">Functions</a></h2>
<h3 id="constructor-2"><a class="header" href="#constructor-2">constructor</a></h3>
<p>Creates an <code>Application</code> contract.</p>
<pre><code class="language-solidity">constructor(IConsensus consensus, address initialOwner, bytes32 templateHash) Ownable(initialOwner);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>consensus</code></td><td><code>IConsensus</code></td><td>The initial consensus contract</td></tr>
<tr><td><code>initialOwner</code></td><td><code>address</code></td><td>The initial application owner</td></tr>
<tr><td><code>templateHash</code></td><td><code>bytes32</code></td><td>The initial machine state hash</td></tr>
</tbody></table>
</div>
<h3 id="receive"><a class="header" href="#receive">receive</a></h3>
<p>Accept Ether transfers.</p>
<p><em>If you wish to transfer Ether to an application while informing
the backend of it, then please do so through the Ether portal contract.</em></p>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="executeoutput"><a class="header" href="#executeoutput">executeOutput</a></h3>
<pre><code class="language-solidity">function executeOutput(bytes calldata output, OutputValidityProof calldata proof) external override nonReentrant;
</code></pre>
<h3 id="migratetoconsensus"><a class="header" href="#migratetoconsensus">migrateToConsensus</a></h3>
<pre><code class="language-solidity">function migrateToConsensus(IConsensus newConsensus) external override onlyOwner;
</code></pre>
<h3 id="wasoutputexecuted"><a class="header" href="#wasoutputexecuted">wasOutputExecuted</a></h3>
<pre><code class="language-solidity">function wasOutputExecuted(uint256 outputIndex) external view override returns (bool);
</code></pre>
<h3 id="validateoutput"><a class="header" href="#validateoutput">validateOutput</a></h3>
<pre><code class="language-solidity">function validateOutput(bytes calldata output, OutputValidityProof calldata proof) public view override;
</code></pre>
<h3 id="validateoutputhash"><a class="header" href="#validateoutputhash">validateOutputHash</a></h3>
<pre><code class="language-solidity">function validateOutputHash(bytes32 outputHash, OutputValidityProof calldata proof) public view override;
</code></pre>
<h3 id="gettemplatehash"><a class="header" href="#gettemplatehash">getTemplateHash</a></h3>
<pre><code class="language-solidity">function getTemplateHash() external view override returns (bytes32);
</code></pre>
<h3 id="getconsensus"><a class="header" href="#getconsensus">getConsensus</a></h3>
<pre><code class="language-solidity">function getConsensus() external view override returns (IConsensus);
</code></pre>
<h3 id="_wasclaimaccepted"><a class="header" href="#_wasclaimaccepted">_wasClaimAccepted</a></h3>
<p>Check if an output Merkle root hash was ever accepted by the current consensus.</p>
<pre><code class="language-solidity">function _wasClaimAccepted(bytes32 claim) internal view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>claim</code></td><td><code>bytes32</code></td><td>The output Merkle root hash</td></tr>
</tbody></table>
</div>
<h3 id="_executevoucher"><a class="header" href="#_executevoucher">_executeVoucher</a></h3>
<p>Executes a voucher</p>
<pre><code class="language-solidity">function _executeVoucher(bytes calldata arguments) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>arguments</code></td><td><code>bytes</code></td><td>ABI-encoded arguments</td></tr>
</tbody></table>
</div>
<h3 id="_executedelegatecallvoucher"><a class="header" href="#_executedelegatecallvoucher">_executeDelegateCallVoucher</a></h3>
<p>Executes a delegatecall voucher</p>
<pre><code class="language-solidity">function _executeDelegateCallVoucher(bytes calldata arguments) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>arguments</code></td><td><code>bytes</code></td><td>ABI-encoded arguments</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="applicationfactory"><a class="header" href="#applicationfactory">ApplicationFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/dapp/ApplicationFactory.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/dapp/ApplicationFactory.sol/../../../contracts/dapp/IApplicationFactory.sol/interface.IApplicationFactory.html">IApplicationFactory</a></p>
<p>Allows anyone to reliably deploy a new <code>Application</code> contract.</p>
<h2 id="functions-12"><a class="header" href="#functions-12">Functions</a></h2>
<h3 id="newapplication"><a class="header" href="#newapplication">newApplication</a></h3>
<pre><code class="language-solidity">function newApplication(IConsensus consensus, address appOwner, bytes32 templateHash)
    external
    override
    returns (Application);
</code></pre>
<h3 id="newapplication-1"><a class="header" href="#newapplication-1">newApplication</a></h3>
<pre><code class="language-solidity">function newApplication(IConsensus consensus, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    override
    returns (Application);
</code></pre>
<h3 id="calculateapplicationaddress"><a class="header" href="#calculateapplicationaddress">calculateApplicationAddress</a></h3>
<pre><code class="language-solidity">function calculateApplicationAddress(IConsensus consensus, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    view
    override
    returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iapplication"><a class="header" href="#iapplication">IApplication</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/dapp/IApplication.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC721Receiver, IERC1155Receiver</p>
<p>The base layer incarnation of an application running on the execution layer.</p>
<p>The state of the application advances through inputs sent to an <code>IInputBox</code> contract.</p>
<p>These inputs can be sent either directly, or indirectly through portals.</p>
<p>Reader nodes can retrieve inputs sent to the <code>IInputBox</code> contract through events, and feed them into the machine.</p>
<p>Validator nodes can also submit claims to the <code>IConsensus</code> contract (see the <code>getConsensus</code> function).</p>
<p>Once accepted, claims can be used to validate outputs generated by the machine.</p>
<p>Some outputs are executable, which means they can have on-chain side effects.</p>
<p>Every application is subscribed to some consensus, and may be governed by some owner.
The consensus has the power to accept claims, which, in turn, are used to validate outputs.
Meanwhile, the owner can replace the consensus at any time.
Therefore, the users of an application must trust both the consensus and the application owner.</p>
<p>There are several ownership models to choose from:</p>
<ul>
<li>no owner (address zero)</li>
<li>individual signer (externally-owned account)</li>
<li>multiple signers (multi-sig)</li>
<li>DAO (decentralized autonomous organization)</li>
<li>self-owned application (off-chain governance logic)</li>
</ul>
<p>See <code>IConsensus</code> for examples of consensus models.</p>
<h2 id="functions-13"><a class="header" href="#functions-13">Functions</a></h2>
<h3 id="migratetoconsensus-1"><a class="header" href="#migratetoconsensus-1">migrateToConsensus</a></h3>
<p>Migrate the application to a new consensus.</p>
<p><em>Can only be called by the application owner.</em></p>
<pre><code class="language-solidity">function migrateToConsensus(IConsensus newConsensus) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newConsensus</code></td><td><code>IConsensus</code></td><td>The new consensus</td></tr>
</tbody></table>
</div>
<h3 id="executeoutput-1"><a class="header" href="#executeoutput-1">executeOutput</a></h3>
<p>Execute an output.</p>
<p><em>On a successful execution, emits a <code>OutputExecuted</code> event.</em></p>
<p><em>May raise any of the errors raised by <code>validateOutput</code>,
as well as <code>OutputNotExecutable</code> and <code>OutputNotReexecutable</code>.</em></p>
<pre><code class="language-solidity">function executeOutput(bytes calldata output, OutputValidityProof calldata proof) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>output</code></td><td><code>bytes</code></td><td>The output</td></tr>
<tr><td><code>proof</code></td><td><code>OutputValidityProof</code></td><td>The proof used to validate the output against a claim submitted to the current consensus contract</td></tr>
</tbody></table>
</div>
<h3 id="wasoutputexecuted-1"><a class="header" href="#wasoutputexecuted-1">wasOutputExecuted</a></h3>
<p>Check whether an output has been executed.</p>
<pre><code class="language-solidity">function wasOutputExecuted(uint256 outputIndex) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>outputIndex</code></td><td><code>uint256</code></td><td>The index of output</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the output has been executed before</td></tr>
</tbody></table>
</div>
<h3 id="validateoutput-1"><a class="header" href="#validateoutput-1">validateOutput</a></h3>
<p>Validate an output.</p>
<p><em>May raise any of the errors raised by <code>validateOutputHash</code>.</em></p>
<pre><code class="language-solidity">function validateOutput(bytes calldata output, OutputValidityProof calldata proof) external view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>output</code></td><td><code>bytes</code></td><td>The output</td></tr>
<tr><td><code>proof</code></td><td><code>OutputValidityProof</code></td><td>The proof used to validate the output against a claim submitted to the current consensus contract</td></tr>
</tbody></table>
</div>
<h3 id="validateoutputhash-1"><a class="header" href="#validateoutputhash-1">validateOutputHash</a></h3>
<p>Validate an output hash.</p>
<p><em>May raise <code>InvalidOutputHashesSiblingsArrayLength</code>
or <code>ClaimNotAccepted</code>.</em></p>
<pre><code class="language-solidity">function validateOutputHash(bytes32 outputHash, OutputValidityProof calldata proof) external view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>outputHash</code></td><td><code>bytes32</code></td><td>The output hash</td></tr>
<tr><td><code>proof</code></td><td><code>OutputValidityProof</code></td><td>The proof used to validate the output against a claim submitted to the current consensus contract</td></tr>
</tbody></table>
</div>
<h3 id="gettemplatehash-1"><a class="header" href="#gettemplatehash-1">getTemplateHash</a></h3>
<p>Get the application's template hash.</p>
<pre><code class="language-solidity">function getTemplateHash() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The application's template hash</td></tr>
</tbody></table>
</div>
<h3 id="getconsensus-1"><a class="header" href="#getconsensus-1">getConsensus</a></h3>
<p>Get the current consensus.</p>
<pre><code class="language-solidity">function getConsensus() external view returns (IConsensus);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>IConsensus</code></td><td>The current consensus</td></tr>
</tbody></table>
</div>
<h2 id="events-3"><a class="header" href="#events-3">Events</a></h2>
<h3 id="newconsensus"><a class="header" href="#newconsensus">NewConsensus</a></h3>
<p>MUST trigger when a new consensus is chosen.</p>
<pre><code class="language-solidity">event NewConsensus(IConsensus newConsensus);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newConsensus</code></td><td><code>IConsensus</code></td><td>The new consensus</td></tr>
</tbody></table>
</div>
<h3 id="outputexecuted"><a class="header" href="#outputexecuted">OutputExecuted</a></h3>
<p>MUST trigger when an output is executed.</p>
<pre><code class="language-solidity">event OutputExecuted(uint64 outputIndex, bytes output);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>outputIndex</code></td><td><code>uint64</code></td><td>The index of the output</td></tr>
<tr><td><code>output</code></td><td><code>bytes</code></td><td>The output</td></tr>
</tbody></table>
</div>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="outputnotexecutable"><a class="header" href="#outputnotexecutable">OutputNotExecutable</a></h3>
<p>Could not execute an output, because the application contract doesn't know how to.</p>
<pre><code class="language-solidity">error OutputNotExecutable(bytes output);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>output</code></td><td><code>bytes</code></td><td>The output</td></tr>
</tbody></table>
</div>
<h3 id="outputnotreexecutable"><a class="header" href="#outputnotreexecutable">OutputNotReexecutable</a></h3>
<p>Could not execute an output, because it was already executed.</p>
<pre><code class="language-solidity">error OutputNotReexecutable(bytes output);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>output</code></td><td><code>bytes</code></td><td>The output</td></tr>
</tbody></table>
</div>
<h3 id="invalidoutputhashessiblingsarraylength"><a class="header" href="#invalidoutputhashessiblingsarraylength">InvalidOutputHashesSiblingsArrayLength</a></h3>
<p>Raised when the output hashes siblings array has an invalid size.</p>
<p><em>Please consult <code>CanonicalMachine</code> for the maximum number of outputs.</em></p>
<pre><code class="language-solidity">error InvalidOutputHashesSiblingsArrayLength();
</code></pre>
<h3 id="claimnotaccepted"><a class="header" href="#claimnotaccepted">ClaimNotAccepted</a></h3>
<p>Raised when the required claim was not accepted by the current consensus.</p>
<pre><code class="language-solidity">error ClaimNotAccepted(bytes32 claim);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iapplicationfactory"><a class="header" href="#iapplicationfactory">IApplicationFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/dapp/IApplicationFactory.sol">Git Source</a></p>
<h2 id="functions-14"><a class="header" href="#functions-14">Functions</a></h2>
<h3 id="newapplication-2"><a class="header" href="#newapplication-2">newApplication</a></h3>
<p>Deploy a new application.</p>
<p><em>On success, MUST emit an <code>ApplicationCreated</code> event.</em></p>
<pre><code class="language-solidity">function newApplication(IConsensus consensus, address appOwner, bytes32 templateHash) external returns (Application);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>consensus</code></td><td><code>IConsensus</code></td><td>The initial consensus contract</td></tr>
<tr><td><code>appOwner</code></td><td><code>address</code></td><td>The initial application owner</td></tr>
<tr><td><code>templateHash</code></td><td><code>bytes32</code></td><td>The initial machine state hash</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Application</code></td><td>The application</td></tr>
</tbody></table>
</div>
<h3 id="newapplication-3"><a class="header" href="#newapplication-3">newApplication</a></h3>
<p>Deploy a new application deterministically.</p>
<p><em>On success, MUST emit an <code>ApplicationCreated</code> event.</em></p>
<pre><code class="language-solidity">function newApplication(IConsensus consensus, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    returns (Application);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>consensus</code></td><td><code>IConsensus</code></td><td>The initial consensus contract</td></tr>
<tr><td><code>appOwner</code></td><td><code>address</code></td><td>The initial application owner</td></tr>
<tr><td><code>templateHash</code></td><td><code>bytes32</code></td><td>The initial machine state hash</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the application contract address</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Application</code></td><td>The application</td></tr>
</tbody></table>
</div>
<h3 id="calculateapplicationaddress-1"><a class="header" href="#calculateapplicationaddress-1">calculateApplicationAddress</a></h3>
<p>Calculate the address of an application contract to be deployed deterministically.</p>
<p><em>Beware that only the <code>newApplication</code> function with the <code>salt</code> parameter
is able to deterministically deploy an application.</em></p>
<pre><code class="language-solidity">function calculateApplicationAddress(IConsensus consensus, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    view
    returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>consensus</code></td><td><code>IConsensus</code></td><td>The initial consensus contract</td></tr>
<tr><td><code>appOwner</code></td><td><code>address</code></td><td>The initial application owner</td></tr>
<tr><td><code>templateHash</code></td><td><code>bytes32</code></td><td>The initial machine state hash</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the application contract address</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The deterministic application contract address</td></tr>
</tbody></table>
</div>
<h2 id="events-4"><a class="header" href="#events-4">Events</a></h2>
<h3 id="applicationcreated"><a class="header" href="#applicationcreated">ApplicationCreated</a></h3>
<p>A new application was deployed.</p>
<p><em>MUST be triggered on a successful call to <code>newApplication</code>.</em></p>
<pre><code class="language-solidity">event ApplicationCreated(IConsensus indexed consensus, address appOwner, bytes32 templateHash, Application appContract);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>consensus</code></td><td><code>IConsensus</code></td><td>The initial consensus contract</td></tr>
<tr><td><code>appOwner</code></td><td><code>address</code></td><td>The initial application owner</td></tr>
<tr><td><code>templateHash</code></td><td><code>bytes32</code></td><td>The initial machine state hash</td></tr>
<tr><td><code>appContract</code></td><td><code>Application</code></td><td>The application contract</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="iselfhostedapplicationfactory"><a class="header" href="#iselfhostedapplicationfactory">ISelfHostedApplicationFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/dapp/ISelfHostedApplicationFactory.sol">Git Source</a></p>
<h2 id="functions-15"><a class="header" href="#functions-15">Functions</a></h2>
<h3 id="getauthorityfactory"><a class="header" href="#getauthorityfactory">getAuthorityFactory</a></h3>
<p>Get the factory used to deploy <code>Authority</code> contracts</p>
<pre><code class="language-solidity">function getAuthorityFactory() external view returns (IAuthorityFactory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>IAuthorityFactory</code></td><td>The authority factory</td></tr>
</tbody></table>
</div>
<h3 id="getapplicationfactory"><a class="header" href="#getapplicationfactory">getApplicationFactory</a></h3>
<p>Get the factory used to deploy <code>Application</code> contracts</p>
<pre><code class="language-solidity">function getApplicationFactory() external view returns (IApplicationFactory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>IApplicationFactory</code></td><td>The application factory</td></tr>
</tbody></table>
</div>
<h3 id="deploycontracts"><a class="header" href="#deploycontracts">deployContracts</a></h3>
<p>Deploy new application and authority contracts deterministically.</p>
<pre><code class="language-solidity">function deployContracts(address authorityOwner, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    returns (Application, Authority);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>authorityOwner</code></td><td><code>address</code></td><td>The initial authority owner</td></tr>
<tr><td><code>appOwner</code></td><td><code>address</code></td><td>The initial Application owner</td></tr>
<tr><td><code>templateHash</code></td><td><code>bytes32</code></td><td>The initial machine state hash</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the addresses</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Application</code></td><td>The application contract</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>Authority</code></td><td>The authority contract</td></tr>
</tbody></table>
</div>
<h3 id="calculateaddresses"><a class="header" href="#calculateaddresses">calculateAddresses</a></h3>
<p>Calculate the addresses of the application and authority contracts
to be deployed deterministically.</p>
<pre><code class="language-solidity">function calculateAddresses(address authorityOwner, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    view
    returns (address, address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>authorityOwner</code></td><td><code>address</code></td><td>The initial authority owner</td></tr>
<tr><td><code>appOwner</code></td><td><code>address</code></td><td>The initial Application owner</td></tr>
<tr><td><code>templateHash</code></td><td><code>bytes32</code></td><td>The initial machine state hash</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>The salt used to deterministically generate the addresses</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The application address</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The authority address</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="selfhostedapplicationfactory"><a class="header" href="#selfhostedapplicationfactory">SelfHostedApplicationFactory</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/dapp/SelfHostedApplicationFactory.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/dapp/SelfHostedApplicationFactory.sol/../../../contracts/dapp/ISelfHostedApplicationFactory.sol/interface.ISelfHostedApplicationFactory.html">ISelfHostedApplicationFactory</a></p>
<p>Allows anyone to reliably deploy a new Authority contract,
along with an Application contract already linked to it.</p>
<h2 id="state-variables-4"><a class="header" href="#state-variables-4">State Variables</a></h2>
<h3 id="_authorityfactory"><a class="header" href="#_authorityfactory">_authorityFactory</a></h3>
<pre><code class="language-solidity">IAuthorityFactory immutable _authorityFactory;
</code></pre>
<h3 id="_applicationfactory"><a class="header" href="#_applicationfactory">_applicationFactory</a></h3>
<pre><code class="language-solidity">IApplicationFactory immutable _applicationFactory;
</code></pre>
<h2 id="functions-16"><a class="header" href="#functions-16">Functions</a></h2>
<h3 id="constructor-3"><a class="header" href="#constructor-3">constructor</a></h3>
<pre><code class="language-solidity">constructor(IAuthorityFactory authorityFactory, IApplicationFactory applicationFactory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>authorityFactory</code></td><td><code>IAuthorityFactory</code></td><td>The authority factory</td></tr>
<tr><td><code>applicationFactory</code></td><td><code>IApplicationFactory</code></td><td>The application factory</td></tr>
</tbody></table>
</div>
<h3 id="getauthorityfactory-1"><a class="header" href="#getauthorityfactory-1">getAuthorityFactory</a></h3>
<pre><code class="language-solidity">function getAuthorityFactory() external view override returns (IAuthorityFactory);
</code></pre>
<h3 id="getapplicationfactory-1"><a class="header" href="#getapplicationfactory-1">getApplicationFactory</a></h3>
<pre><code class="language-solidity">function getApplicationFactory() external view override returns (IApplicationFactory);
</code></pre>
<h3 id="deploycontracts-1"><a class="header" href="#deploycontracts-1">deployContracts</a></h3>
<pre><code class="language-solidity">function deployContracts(address authorityOwner, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    returns (Application application, Authority authority);
</code></pre>
<h3 id="calculateaddresses-1"><a class="header" href="#calculateaddresses-1">calculateAddresses</a></h3>
<pre><code class="language-solidity">function calculateAddresses(address authorityOwner, address appOwner, bytes32 templateHash, bytes32 salt)
    external
    view
    returns (address application, address authority);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-5"><a class="header" href="#contents-5">Contents</a></h1>
<ul>
<li><a href="contracts/delegatecall/SafeERC20Transfer.sol/contract.SafeERC20Transfer.html">SafeERC20Transfer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="safeerc20transfer"><a class="header" href="#safeerc20transfer">SafeERC20Transfer</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/delegatecall/SafeERC20Transfer.sol">Git Source</a></p>
<h2 id="functions-17"><a class="header" href="#functions-17">Functions</a></h2>
<h3 id="safetransfer"><a class="header" href="#safetransfer">safeTransfer</a></h3>
<pre><code class="language-solidity">function safeTransfer(IERC20 token, address to, uint256 value) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-6"><a class="header" href="#contents-6">Contents</a></h1>
<ul>
<li><a href="contracts/inputs/IInputBox.sol/interface.IInputBox.html">IInputBox</a></li>
<li><a href="contracts/inputs/InputBox.sol/contract.InputBox.html">InputBox</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iinputbox"><a class="header" href="#iinputbox">IInputBox</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/inputs/IInputBox.sol">Git Source</a></p>
<p>Provides data availability of inputs for applications.</p>
<p>Each application has its own append-only list of inputs.</p>
<p>Off-chain, inputs can be retrieved via events.</p>
<p>On-chain, only the input hashes are stored.</p>
<p>See <code>LibInput</code> for more details on how such hashes are computed.</p>
<h2 id="functions-18"><a class="header" href="#functions-18">Functions</a></h2>
<h3 id="addinput"><a class="header" href="#addinput">addInput</a></h3>
<p>Send an input to an application.</p>
<p><em>MUST fire an <code>InputAdded</code> event.</em></p>
<pre><code class="language-solidity">function addInput(address appContract, bytes calldata payload) external returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>The input payload</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The hash of the input blob</td></tr>
</tbody></table>
</div>
<h3 id="getnumberofinputs"><a class="header" href="#getnumberofinputs">getNumberOfInputs</a></h3>
<p>Get the number of inputs sent to an application.</p>
<pre><code class="language-solidity">function getNumberOfInputs(address appContract) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
</tbody></table>
</div>
<h3 id="getinputhash"><a class="header" href="#getinputhash">getInputHash</a></h3>
<p>Get the hash of an input in an application's input box.</p>
<p><em>The provided index must be valid.</em></p>
<pre><code class="language-solidity">function getInputHash(address appContract, uint256 index) external view returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The input index</td></tr>
</tbody></table>
</div>
<h2 id="events-5"><a class="header" href="#events-5">Events</a></h2>
<h3 id="inputadded"><a class="header" href="#inputadded">InputAdded</a></h3>
<p>MUST trigger when an input is added.</p>
<pre><code class="language-solidity">event InputAdded(address indexed appContract, uint256 indexed index, bytes input);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The input index</td></tr>
<tr><td><code>input</code></td><td><code>bytes</code></td><td>The input blob</td></tr>
</tbody></table>
</div>
<h2 id="errors-1"><a class="header" href="#errors-1">Errors</a></h2>
<h3 id="inputtoolarge"><a class="header" href="#inputtoolarge">InputTooLarge</a></h3>
<p>Input is too large.</p>
<pre><code class="language-solidity">error InputTooLarge(address appContract, uint256 inputLength, uint256 maxInputLength);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>inputLength</code></td><td><code>uint256</code></td><td>The input length</td></tr>
<tr><td><code>maxInputLength</code></td><td><code>uint256</code></td><td>The maximum input length</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="inputbox"><a class="header" href="#inputbox">InputBox</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/inputs/InputBox.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/inputs/InputBox.sol/../../../contracts/inputs/IInputBox.sol/interface.IInputBox.html">IInputBox</a></p>
<h2 id="state-variables-5"><a class="header" href="#state-variables-5">State Variables</a></h2>
<h3 id="_inputboxes"><a class="header" href="#_inputboxes">_inputBoxes</a></h3>
<p>Mapping of application contract addresses to arrays of input hashes.</p>
<pre><code class="language-solidity">mapping(address =&gt; bytes32[]) private _inputBoxes;
</code></pre>
<h2 id="functions-19"><a class="header" href="#functions-19">Functions</a></h2>
<h3 id="addinput-1"><a class="header" href="#addinput-1">addInput</a></h3>
<p>Send an input to an application.</p>
<p><em>MUST fire an <code>InputAdded</code> event.</em></p>
<pre><code class="language-solidity">function addInput(address appContract, bytes calldata payload) external override returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>The input payload</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The hash of the input blob</td></tr>
</tbody></table>
</div>
<h3 id="getnumberofinputs-1"><a class="header" href="#getnumberofinputs-1">getNumberOfInputs</a></h3>
<p>Get the number of inputs sent to an application.</p>
<pre><code class="language-solidity">function getNumberOfInputs(address appContract) external view override returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
</tbody></table>
</div>
<h3 id="getinputhash-1"><a class="header" href="#getinputhash-1">getInputHash</a></h3>
<p>Get the hash of an input in an application's input box.</p>
<p><em>The provided index must be valid.</em></p>
<pre><code class="language-solidity">function getInputHash(address appContract, uint256 index) external view override returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The input index</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-7"><a class="header" href="#contents-7">Contents</a></h1>
<ul>
<li><a href="contracts/library/LibAddress.sol/library.LibAddress.html">LibAddress</a></li>
<li><a href="contracts/library/LibError.sol/library.LibError.html">LibError</a></li>
<li><a href="contracts/library/LibMerkle32.sol/library.LibMerkle32.html">LibMerkle32</a></li>
<li><a href="contracts/library/LibOutputValidityProof.sol/library.LibOutputValidityProof.html">LibOutputValidityProof</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="libaddress"><a class="header" href="#libaddress">LibAddress</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/library/LibAddress.sol">Git Source</a></p>
<h2 id="functions-20"><a class="header" href="#functions-20">Functions</a></h2>
<h3 id="safecall"><a class="header" href="#safecall">safeCall</a></h3>
<p>Perform a low level call and raise error if failed</p>
<pre><code class="language-solidity">function safeCall(address destination, uint256 value, bytes memory payload) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>destination</code></td><td><code>address</code></td><td>The address that will be called</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The amount of Wei to be transferred through the call</td></tr>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>The payload, which‚Äîin the case of Solidity contracts‚Äîencodes a function call</td></tr>
</tbody></table>
</div>
<h3 id="safedelegatecall"><a class="header" href="#safedelegatecall">safeDelegateCall</a></h3>
<p>Perform a delegate call and raise error if failed</p>
<pre><code class="language-solidity">function safeDelegateCall(address destination, bytes memory payload) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>destination</code></td><td><code>address</code></td><td>The address that will be called</td></tr>
<tr><td><code>payload</code></td><td><code>bytes</code></td><td>The payload, which‚Äîin the case of Solidity libraries‚Äîencodes a function call</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="liberror"><a class="header" href="#liberror">LibError</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/library/LibError.sol">Git Source</a></p>
<h2 id="functions-21"><a class="header" href="#functions-21">Functions</a></h2>
<h3 id="raise"><a class="header" href="#raise">raise</a></h3>
<p>Raise error data</p>
<pre><code class="language-solidity">function raise(bytes memory errordata) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>errordata</code></td><td><code>bytes</code></td><td>Data returned by failed low-level call</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="libmerkle32"><a class="header" href="#libmerkle32">LibMerkle32</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/library/LibMerkle32.sol">Git Source</a></p>
<p>This library is meant for creating and verifying Merkle proofs.</p>
<p>Each Merkle tree is assumed to have <code>2^height</code> leaves.</p>
<p>Nodes are concatenated pairwise and hashed with <code>keccak256</code>.</p>
<p>Siblings are in bottom-up order, from leaf to root.</p>
<h2 id="functions-22"><a class="header" href="#functions-22">Functions</a></h2>
<h3 id="merkleroot"><a class="header" href="#merkleroot">merkleRoot</a></h3>
<p>Compute the root of a Merkle tree from its leaves.</p>
<p><em>Raises an error if more than <code>2^height</code> leaves are provided.</em></p>
<pre><code class="language-solidity">function merkleRoot(bytes32[] memory leaves, uint256 height) internal pure returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>leaves</code></td><td><code>bytes32[]</code></td><td>The left-most leaves of the Merkle tree</td></tr>
<tr><td><code>height</code></td><td><code>uint256</code></td><td>The height of the Merkle tree</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The root hash of the Merkle tree</td></tr>
</tbody></table>
</div>
<h3 id="siblings"><a class="header" href="#siblings">siblings</a></h3>
<p>Compute the siblings of the ancestors of a leaf in a Merkle tree.</p>
<p><em>Raises an error if the provided index is out of bounds.</em></p>
<p><em>Raises an error if more than <code>2^height</code> leaves are provided.</em></p>
<pre><code class="language-solidity">function siblings(bytes32[] memory leaves, uint256 index, uint256 height) internal pure returns (bytes32[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>leaves</code></td><td><code>bytes32[]</code></td><td>The left-most leaves of the Merkle tree</td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The index of the leaf</td></tr>
<tr><td><code>height</code></td><td><code>uint256</code></td><td>The height of the Merkle tree</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32[]</code></td><td>The siblings of the ancestors of the leaf in bottom-up order</td></tr>
</tbody></table>
</div>
<h3 id="merklerootafterreplacement"><a class="header" href="#merklerootafterreplacement">merkleRootAfterReplacement</a></h3>
<p>Compute the root of a Merkle tree after replacing one of its leaves.</p>
<p><em>Raises an error if the provided index is out of bounds.</em></p>
<pre><code class="language-solidity">function merkleRootAfterReplacement(bytes32[] calldata sibs, uint256 index, bytes32 leaf)
    internal
    pure
    returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sibs</code></td><td><code>bytes32[]</code></td><td>The siblings of the ancestors of the leaf in bottom-up order</td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The index of the leaf</td></tr>
<tr><td><code>leaf</code></td><td><code>bytes32</code></td><td>The new leaf</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The root hash of the new Merkle tree</td></tr>
</tbody></table>
</div>
<h3 id="parent"><a class="header" href="#parent">parent</a></h3>
<p>Compute the parent of two nodes.</p>
<p><em>Uses assembly for extra performance</em></p>
<pre><code class="language-solidity">function parent(bytes32 leftNode, bytes32 rightNode) internal pure returns (bytes32 parentNode);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>leftNode</code></td><td><code>bytes32</code></td><td>The left node</td></tr>
<tr><td><code>rightNode</code></td><td><code>bytes32</code></td><td>The right node</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>parentNode</code></td><td><code>bytes32</code></td><td>The parent node</td></tr>
</tbody></table>
</div>
<h3 id="parentlevel"><a class="header" href="#parentlevel">parentLevel</a></h3>
<p>Compute the parent level of an array of nodes.</p>
<p><em>The default node of a parent level is
the parent node of two default nodes.</em></p>
<pre><code class="language-solidity">function parentLevel(bytes32[] memory nodes, bytes32 defaultNode) internal pure returns (bytes32[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>nodes</code></td><td><code>bytes32[]</code></td><td>The array of left-most nodes</td></tr>
<tr><td><code>defaultNode</code></td><td><code>bytes32</code></td><td>The default node after the array</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32[]</code></td><td>The left-most nodes of the parent level</td></tr>
</tbody></table>
</div>
<h3 id="at"><a class="header" href="#at">at</a></h3>
<p>Get the node at some index</p>
<pre><code class="language-solidity">function at(bytes32[] memory nodes, uint256 index, bytes32 defaultNode) internal pure returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>nodes</code></td><td><code>bytes32[]</code></td><td>The array of left-most nodes</td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The index of the node</td></tr>
<tr><td><code>defaultNode</code></td><td><code>bytes32</code></td><td>The default node after the array</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="liboutputvalidityproof"><a class="header" href="#liboutputvalidityproof">LibOutputValidityProof</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/library/LibOutputValidityProof.sol">Git Source</a></p>
<h2 id="functions-23"><a class="header" href="#functions-23">Functions</a></h2>
<h3 id="issiblingsarraylengthvalid"><a class="header" href="#issiblingsarraylengthvalid">isSiblingsArrayLengthValid</a></h3>
<pre><code class="language-solidity">function isSiblingsArrayLengthValid(OutputValidityProof calldata v) internal pure returns (bool);
</code></pre>
<h3 id="computeclaim"><a class="header" href="#computeclaim">computeClaim</a></h3>
<pre><code class="language-solidity">function computeClaim(OutputValidityProof calldata v, bytes32 outputHash) internal pure returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-8"><a class="header" href="#contents-8">Contents</a></h1>
<ul>
<li><a href="contracts/portals/ERC1155BatchPortal.sol/contract.ERC1155BatchPortal.html">ERC1155BatchPortal</a></li>
<li><a href="contracts/portals/ERC1155SinglePortal.sol/contract.ERC1155SinglePortal.html">ERC1155SinglePortal</a></li>
<li><a href="contracts/portals/ERC20Portal.sol/contract.ERC20Portal.html">ERC20Portal</a></li>
<li><a href="contracts/portals/ERC721Portal.sol/contract.ERC721Portal.html">ERC721Portal</a></li>
<li><a href="contracts/portals/EtherPortal.sol/contract.EtherPortal.html">EtherPortal</a></li>
<li><a href="contracts/portals/IERC1155BatchPortal.sol/interface.IERC1155BatchPortal.html">IERC1155BatchPortal</a></li>
<li><a href="contracts/portals/IERC1155SinglePortal.sol/interface.IERC1155SinglePortal.html">IERC1155SinglePortal</a></li>
<li><a href="contracts/portals/IERC20Portal.sol/interface.IERC20Portal.html">IERC20Portal</a></li>
<li><a href="contracts/portals/IERC721Portal.sol/interface.IERC721Portal.html">IERC721Portal</a></li>
<li><a href="contracts/portals/IEtherPortal.sol/interface.IEtherPortal.html">IEtherPortal</a></li>
<li><a href="contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></li>
<li><a href="contracts/portals/Portal.sol/contract.Portal.html">Portal</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc1155batchportal"><a class="header" href="#erc1155batchportal">ERC1155BatchPortal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/ERC1155BatchPortal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/ERC1155BatchPortal.sol/../../../contracts/portals/IERC1155BatchPortal.sol/interface.IERC1155BatchPortal.html">IERC1155BatchPortal</a>, <a href="contracts/portals/ERC1155BatchPortal.sol/../../../contracts/portals/Portal.sol/contract.Portal.html">Portal</a></p>
<p>This contract allows anyone to perform batch transfers of
ERC-1155 tokens to an application contract while informing the off-chain machine.</p>
<h2 id="functions-24"><a class="header" href="#functions-24">Functions</a></h2>
<h3 id="constructor-4"><a class="header" href="#constructor-4">constructor</a></h3>
<p>Constructs the portal.</p>
<pre><code class="language-solidity">constructor(IInputBox inputBox) Portal(inputBox);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>inputBox</code></td><td><code>IInputBox</code></td><td>The input box used by the portal</td></tr>
</tbody></table>
</div>
<h3 id="depositbatcherc1155token"><a class="header" href="#depositbatcherc1155token">depositBatchERC1155Token</a></h3>
<pre><code class="language-solidity">function depositBatchERC1155Token(
    IERC1155 token,
    address appContract,
    uint256[] calldata tokenIds,
    uint256[] calldata values,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) external override;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc1155singleportal"><a class="header" href="#erc1155singleportal">ERC1155SinglePortal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/ERC1155SinglePortal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/ERC1155SinglePortal.sol/../../../contracts/portals/IERC1155SinglePortal.sol/interface.IERC1155SinglePortal.html">IERC1155SinglePortal</a>, <a href="contracts/portals/ERC1155SinglePortal.sol/../../../contracts/portals/Portal.sol/contract.Portal.html">Portal</a></p>
<p>This contract allows anyone to perform single transfers of
ERC-1155 tokens to an application contract while informing the off-chain machine.</p>
<h2 id="functions-25"><a class="header" href="#functions-25">Functions</a></h2>
<h3 id="constructor-5"><a class="header" href="#constructor-5">constructor</a></h3>
<p>Constructs the portal.</p>
<pre><code class="language-solidity">constructor(IInputBox inputBox) Portal(inputBox);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>inputBox</code></td><td><code>IInputBox</code></td><td>The input box used by the portal</td></tr>
</tbody></table>
</div>
<h3 id="depositsingleerc1155token"><a class="header" href="#depositsingleerc1155token">depositSingleERC1155Token</a></h3>
<pre><code class="language-solidity">function depositSingleERC1155Token(
    IERC1155 token,
    address appContract,
    uint256 tokenId,
    uint256 value,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) external override;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc20portal"><a class="header" href="#erc20portal">ERC20Portal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/ERC20Portal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/ERC20Portal.sol/../../../contracts/portals/IERC20Portal.sol/interface.IERC20Portal.html">IERC20Portal</a>, <a href="contracts/portals/ERC20Portal.sol/../../../contracts/portals/Portal.sol/contract.Portal.html">Portal</a></p>
<p>This contract allows anyone to perform transfers of
ERC-20 tokens to an application contract while informing the off-chain machine.</p>
<h2 id="functions-26"><a class="header" href="#functions-26">Functions</a></h2>
<h3 id="constructor-6"><a class="header" href="#constructor-6">constructor</a></h3>
<p>Constructs the portal.</p>
<pre><code class="language-solidity">constructor(IInputBox inputBox) Portal(inputBox);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>inputBox</code></td><td><code>IInputBox</code></td><td>The input box used by the portal</td></tr>
</tbody></table>
</div>
<h3 id="depositerc20tokens"><a class="header" href="#depositerc20tokens">depositERC20Tokens</a></h3>
<pre><code class="language-solidity">function depositERC20Tokens(IERC20 token, address appContract, uint256 value, bytes calldata execLayerData)
    external
    override;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc721portal"><a class="header" href="#erc721portal">ERC721Portal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/ERC721Portal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/ERC721Portal.sol/../../../contracts/portals/IERC721Portal.sol/interface.IERC721Portal.html">IERC721Portal</a>, <a href="contracts/portals/ERC721Portal.sol/../../../contracts/portals/Portal.sol/contract.Portal.html">Portal</a></p>
<p>This contract allows anyone to perform transfers of
ERC-721 tokens to an application contract while informing the off-chain machine.</p>
<h2 id="functions-27"><a class="header" href="#functions-27">Functions</a></h2>
<h3 id="constructor-7"><a class="header" href="#constructor-7">constructor</a></h3>
<p>Constructs the portal.</p>
<pre><code class="language-solidity">constructor(IInputBox inputBox) Portal(inputBox);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>inputBox</code></td><td><code>IInputBox</code></td><td>The input box used by the portal</td></tr>
</tbody></table>
</div>
<h3 id="depositerc721token"><a class="header" href="#depositerc721token">depositERC721Token</a></h3>
<pre><code class="language-solidity">function depositERC721Token(
    IERC721 token,
    address appContract,
    uint256 tokenId,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) external override;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="etherportal"><a class="header" href="#etherportal">EtherPortal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/EtherPortal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/EtherPortal.sol/../../../contracts/portals/IEtherPortal.sol/interface.IEtherPortal.html">IEtherPortal</a>, <a href="contracts/portals/EtherPortal.sol/../../../contracts/portals/Portal.sol/contract.Portal.html">Portal</a></p>
<p>This contract allows anyone to perform transfers of
Ether to an application contract while informing the off-chain machine.</p>
<h2 id="functions-28"><a class="header" href="#functions-28">Functions</a></h2>
<h3 id="constructor-8"><a class="header" href="#constructor-8">constructor</a></h3>
<p>Constructs the portal.</p>
<pre><code class="language-solidity">constructor(IInputBox inputBox) Portal(inputBox);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>inputBox</code></td><td><code>IInputBox</code></td><td>The input box used by the portal</td></tr>
</tbody></table>
</div>
<h3 id="depositether"><a class="header" href="#depositether">depositEther</a></h3>
<pre><code class="language-solidity">function depositEther(address appContract, bytes calldata execLayerData) external payable override;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ierc1155batchportal"><a class="header" href="#ierc1155batchportal">IERC1155BatchPortal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/IERC1155BatchPortal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/IERC1155BatchPortal.sol/../../../contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></p>
<h2 id="functions-29"><a class="header" href="#functions-29">Functions</a></h2>
<h3 id="depositbatcherc1155token-1"><a class="header" href="#depositbatcherc1155token-1">depositBatchERC1155Token</a></h3>
<p>Transfer a batch of ERC-1155 tokens of multiple types to an application contract
and add an input to the application's input box to signal such operation.
The caller must enable approval for the portal to manage all of their tokens
beforehand, by calling the <code>setApprovalForAll</code> function in the token contract.</p>
<p><em>Please make sure the arrays <code>tokenIds</code> and <code>values</code> have the same length.</em></p>
<pre><code class="language-solidity">function depositBatchERC1155Token(
    IERC1155 token,
    address appContract,
    uint256[] calldata tokenIds,
    uint256[] calldata values,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC1155</code></td><td>The ERC-1155 token contract</td></tr>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>tokenIds</code></td><td><code>uint256[]</code></td><td>The identifiers of the tokens being transferred</td></tr>
<tr><td><code>values</code></td><td><code>uint256[]</code></td><td>Transfer amounts per token type</td></tr>
<tr><td><code>baseLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the base layer</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ierc1155singleportal"><a class="header" href="#ierc1155singleportal">IERC1155SinglePortal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/IERC1155SinglePortal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/IERC1155SinglePortal.sol/../../../contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></p>
<h2 id="functions-30"><a class="header" href="#functions-30">Functions</a></h2>
<h3 id="depositsingleerc1155token-1"><a class="header" href="#depositsingleerc1155token-1">depositSingleERC1155Token</a></h3>
<p>Transfer ERC-1155 tokens of a single type to an application contract
and add an input to the application's input box to signal such operation.
The caller must enable approval for the portal to manage all of their tokens
beforehand, by calling the <code>setApprovalForAll</code> function in the token contract.</p>
<pre><code class="language-solidity">function depositSingleERC1155Token(
    IERC1155 token,
    address appContract,
    uint256 tokenId,
    uint256 value,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC1155</code></td><td>The ERC-1155 token contract</td></tr>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The identifier of the token being transferred</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>Transfer amount</td></tr>
<tr><td><code>baseLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the base layer</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ierc20portal"><a class="header" href="#ierc20portal">IERC20Portal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/IERC20Portal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/IERC20Portal.sol/../../../contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></p>
<h2 id="functions-31"><a class="header" href="#functions-31">Functions</a></h2>
<h3 id="depositerc20tokens-1"><a class="header" href="#depositerc20tokens-1">depositERC20Tokens</a></h3>
<p>Transfer ERC-20 tokens to an application contract
and add an input to the application's input box to signal such operation.
The caller must allow the portal to withdraw at least <code>value</code> tokens
from their account beforehand, by calling the <code>approve</code> function in the
token contract.</p>
<pre><code class="language-solidity">function depositERC20Tokens(IERC20 token, address appContract, uint256 value, bytes calldata execLayerData) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC20</code></td><td>The ERC-20 token contract</td></tr>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The amount of tokens to be transferred</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div>
<h2 id="errors-2"><a class="header" href="#errors-2">Errors</a></h2>
<h3 id="erc20transferfailed"><a class="header" href="#erc20transferfailed">ERC20TransferFailed</a></h3>
<p>Failed to transfer ERC-20 tokens to application</p>
<pre><code class="language-solidity">error ERC20TransferFailed();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ierc721portal"><a class="header" href="#ierc721portal">IERC721Portal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/IERC721Portal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/IERC721Portal.sol/../../../contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></p>
<h2 id="functions-32"><a class="header" href="#functions-32">Functions</a></h2>
<h3 id="depositerc721token-1"><a class="header" href="#depositerc721token-1">depositERC721Token</a></h3>
<p>Transfer an ERC-721 token to an application contract
and add an input to the application's input box to signal such operation.
The caller must change the approved address for the ERC-721 token
to the portal address beforehand, by calling the <code>approve</code> function in the
token contract.</p>
<pre><code class="language-solidity">function depositERC721Token(
    IERC721 token,
    address appContract,
    uint256 tokenId,
    bytes calldata baseLayerData,
    bytes calldata execLayerData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>IERC721</code></td><td>The ERC-721 token contract</td></tr>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The identifier of the token being transferred</td></tr>
<tr><td><code>baseLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the base layer</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ietherportal"><a class="header" href="#ietherportal">IEtherPortal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/IEtherPortal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/IEtherPortal.sol/../../../contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></p>
<h2 id="functions-33"><a class="header" href="#functions-33">Functions</a></h2>
<h3 id="depositether-1"><a class="header" href="#depositether-1">depositEther</a></h3>
<p>Transfer Ether to an application contract
and add an input to the application's input box to signal such operation.</p>
<p><em>Any Ether sent through this function will be forwarded to the application contract.
If the transfer fails, an <code>EtherTransferFailed</code> error will be raised.</em></p>
<pre><code class="language-solidity">function depositEther(address appContract, bytes calldata execLayerData) external payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>appContract</code></td><td><code>address</code></td><td>The application contract address</td></tr>
<tr><td><code>execLayerData</code></td><td><code>bytes</code></td><td>Additional data to be interpreted by the execution layer</td></tr>
</tbody></table>
</div>
<h2 id="errors-3"><a class="header" href="#errors-3">Errors</a></h2>
<h3 id="ethertransferfailed"><a class="header" href="#ethertransferfailed">EtherTransferFailed</a></h3>
<p>Failed to transfer Ether to application</p>
<pre><code class="language-solidity">error EtherTransferFailed();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iportal"><a class="header" href="#iportal">IPortal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/IPortal.sol">Git Source</a></p>
<h2 id="functions-34"><a class="header" href="#functions-34">Functions</a></h2>
<h3 id="getinputbox"><a class="header" href="#getinputbox">getInputBox</a></h3>
<p>Get the input box used by this portal.</p>
<pre><code class="language-solidity">function getInputBox() external view returns (IInputBox);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>IInputBox</code></td><td>The input box</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="portal"><a class="header" href="#portal">Portal</a></h1>
<p><a href="https://github.com/cartesi/rollups-contracts/blob/e50e53d7ba52999f5d6a12a029807171050e28c0/contracts/portals/Portal.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/portals/Portal.sol/../../../contracts/portals/IPortal.sol/interface.IPortal.html">IPortal</a></p>
<p>This contract serves as a base for all the other portals.</p>
<h2 id="state-variables-6"><a class="header" href="#state-variables-6">State Variables</a></h2>
<h3 id="_inputbox"><a class="header" href="#_inputbox">_inputBox</a></h3>
<p>The input box used by the portal.</p>
<pre><code class="language-solidity">IInputBox internal immutable _inputBox;
</code></pre>
<h2 id="functions-35"><a class="header" href="#functions-35">Functions</a></h2>
<h3 id="constructor-9"><a class="header" href="#constructor-9">constructor</a></h3>
<p>Constructs the portal.</p>
<pre><code class="language-solidity">constructor(IInputBox inputBox);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>inputBox</code></td><td><code>IInputBox</code></td><td>The input box used by the portal</td></tr>
</tbody></table>
</div>
<h3 id="getinputbox-1"><a class="header" href="#getinputbox-1">getInputBox</a></h3>
<pre><code class="language-solidity">function getInputBox() external view override returns (IInputBox);
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
